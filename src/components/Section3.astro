---
import { Image } from "astro:assets";
import { Icon } from "astro-icon/components";
import Pattern from "./Pattern.astro";

import Gameplay1 from "../assets/images/gameplay1.png";
import Gameplay2 from "../assets/images/gameplay2.png";
import Gameplay3 from "../assets/images/gameplay3.png";
import Gameplay4 from "../assets/images/gameplay4.png";
---

<section
  class="relative top-0 h-screen z-40 bg-[url('/purple-background.png')] bg-cover bg-center bg-fixed flex flex-col items-center justify-center lg:justify-start px-6 text-white overflow-hidden pt-44 pb-20"
>
  <Pattern />

  <!-- Título centrado -->
  <div class="text-center mb-12 z-30 w-full">
    <h2
      class="font-lilita text-white text-4xl sm:text-5xl md:text-6xl lg:text-[100px] font-extrabold drop-shadow-[5px_5px_0_rgba(0,0,0,1)] -rotate-2"
    >
      ¿Estás preparado?
    </h2>
  </div>

  <!-- Carrusel centrado -->
  <div class="w-full flex flex-col items-center z-20">
    <div
      id="carousel"
      class="relative overflow-hidden rounded-xl shadow-2xl w-[90vw] sm:w-[80vw] md:w-[60vw] lg:w-[50vw] aspect-video"
    >
      <div
        class="fade-image absolute inset-0 opacity-100 transition-opacity duration-1000"
      >
        <Image
          src={Gameplay1}
          alt="Gameplay 1"
          class="w-full h-full object-cover rounded-xl"
        />
      </div>
      <div
        class="fade-image absolute inset-0 opacity-0 transition-opacity duration-1000"
      >
        <Image
          src={Gameplay2}
          alt="Gameplay 2"
          class="w-full h-full object-cover rounded-xl"
        />
      </div>
      <div
        class="fade-image absolute inset-0 opacity-0 transition-opacity duration-1000"
      >
        <Image
          src={Gameplay3}
          alt="Gameplay 3"
          class="w-full h-full object-cover rounded-xl"
        />
      </div>
      <div
        class="fade-image absolute inset-0 opacity-0 transition-opacity duration-1000"
      >
        <Image
          src={Gameplay4}
          alt="Gameplay 4"
          class="w-full h-full object-cover rounded-xl"
        />
      </div>
    </div>

    <!-- Botones -->
    <div class="flex justify-center gap-4 mt-6">
      <Icon
        id="prev"
        name="arrow-left"
        class="w-12 h-full text-yellow-400 drop-shadow-[3px_3px_0_rgba(0,0,0,1)]"
      />
      <Icon
        id="next"
        name="arrow-right"
        class="w-12 h-full text-yellow-400 drop-shadow-[3px_3px_0_rgba(0,0,0,1)]"
      />
    </div>
  </div>
</section>

<script is:inline>
  const images = document.querySelectorAll(".fade-image");
  const prev = document.getElementById("prev");
  const next = document.getElementById("next");
  let current = 0;
  let interval;

  function showImage(index) {
    images.forEach((img, i) => {
      img.classList.toggle("opacity-100", i === index);
      img.classList.toggle("opacity-0", i !== index);
    });
  }

  function nextImage() {
    current = (current + 1) % images.length;
    showImage(current);
  }

  function prevImage() {
    current = (current - 1 + images.length) % images.length;
    showImage(current);
  }

  function startAuto() {
    interval = setInterval(nextImage, 5000);
  }

  function stopAuto() {
    clearInterval(interval);
  }

  next.addEventListener("click", () => {
    stopAuto();
    nextImage();
    startAuto();
  });

  prev.addEventListener("click", () => {
    stopAuto();
    prevImage();
    startAuto();
  });

  showImage(current);
  startAuto();
</script>
